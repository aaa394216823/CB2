Res_list[[1]] <- Alz_SIM
Res_list[[2]] <- jurkat_SIM
Res_list[[3]] <- MALT_SIM
Res_list[[4]] <- mbrain_SIM
Res_list[[5]] <- mbrain1K_SIM
Res_list[[6]] <- PanT4K_SIM
Res_list[[7]] <- PBMC33K_SIM
Res_list[[8]] <- PBMC4K_SIM
Res_list[[9]] <- PBMC8K_SIM
Res_list[[10]] <- T293_SIM
Size_old <- unlist(lapply(Res_list,function(x) mean(x$Size[,6])))
KL_old <- unlist(lapply(Res_list,function(x) mean(x$KL_Diver[,6])))
KLS <- data.frame(name=NM,KL_new=KL_new,KL_old=KL_old,KL_real=KL_real,
Size_new=Size_new,Size_old=Size_old,Size_knee=Size_knee)
gp <- ggplot(data=KLS, aes(x=KL_real))+geom_point(aes(y=KL_old),col=RED)+geom_point(aes(y=KL_new),col=BLUE)+geom_abline(slope = 1,linetype="dashed")+xlim(0,max(KLS$KL_real))+ylim(0,max(KLS[,2:3]))+ theme_bw() + theme(legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
print(gp)
gp <- ggplot(data=KLS, aes(x=KL_real))+geom_point(aes(y=KL_old),col=RED)+geom_point(aes(y=KL_new),col=BLUE)+geom_abline(slope = 1,linetype="dashed")+xlim(0,max(KLS$KL_real)+0.05)+ylim(0,max(KLS[,2:3])+0.05)+ theme_bw() + theme(legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
print(gp)
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/KL2.tif",width= 12,height=10,units="cm",res=300, compression = "lzw")
print(gp)
dev.off()
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/KL2.tif",width= 10,height=10,units="cm",res=300, compression = "lzw")
print(gp)
dev.off()
gp <- ggplot(data=KLS, aes(x=KL_real))+geom_point(aes(y=KL_old),col=RED)+geom_point(aes(y=KL_new),col=BLUE)+geom_abline(slope = 1,linetype="dashed")+xlim(0,max(KLS$KL_real)*1.2+ylim(0,max(KLS[,2:3])*1.2)+ theme_bw() + theme(legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/KL2.tif",width= 10,height=10,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=KLS, aes(x=KL_real))+geom_point(aes(y=KL_old),col=RED)+geom_point(aes(y=KL_new),col=BLUE)+geom_abline(slope = 1,linetype="dashed")+xlim(0,max(KLS$KL_real)*1.2)+ylim(0,max(KLS[,2:3])*1.2)+ theme_bw() + theme(legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/KL2.tif",width= 10,height=10,units="cm",res=300, compression = "lzw")
print(gp)
dev.off()
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+labs(title="FDR")+
scale_x_discrete(limits=(NM_order))+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+theme(legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/FDR_old1.tif",width=30,height=6,units="cm",res=300, compression = "lzw")
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
dev.off()
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/sim/sim_10_3_old.RData")
Res_list <- list()
Res_list[[1]] <- Alz_SIM
Res_list[[2]] <- jurkat_SIM
Res_list[[3]] <- MALT_SIM
Res_list[[4]] <- mbrain_SIM
Res_list[[5]] <- mbrain1K_SIM
Res_list[[6]] <- PanT4K_SIM
Res_list[[7]] <- PBMC33K_SIM
Res_list[[8]] <- PBMC4K_SIM
Res_list[[9]] <- PBMC8K_SIM
Res_list[[10]] <- T293_SIM
G1E <- unlist(lapply(Res_list,function(x) x$TP_CB2[2,ncol(x$TP_CB2)]))
G1ED <- unlist(lapply(Res_list,function(x) x$TP_ED[2,ncol(x$TP_ED)]))
G2E <- unlist(lapply(Res_list,function(x) x$TP_CB2[4,ncol(x$TP_CB2)]))
G2ED <- unlist(lapply(Res_list,function(x) x$TP_ED[4,ncol(x$TP_ED)]))
G3E <- unlist(lapply(Res_list,function(x) x$TP_CB2[6,ncol(x$TP_CB2)]))
G3ED <- unlist(lapply(Res_list,function(x) x$TP_ED[6,ncol(x$TP_ED)]))
FDR_E <- unlist(lapply(Res_list,function(x) x$Stat[2,1]))
FDR_ED <- unlist(lapply(Res_list,function(x) x$Stat[2,2]))
Power_Inc <- unlist(lapply(Res_list,function(x) x$Power_diff))
NM_order <- c("mbrain1K","T293","jurkat","PanT4K","MALT","PBMC4K","mbrain9K","Alzheimer","PBMC8K","PBMC33K")
FDR_plot <- data.frame(FDR=c(FDR_E,FDR_ED),Dataset=NM,Method=rep(c("CB2","EmptyDrops"),each=10))
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/FDR_old1.tif",width=30,height=6,units="cm",res=300, compression = "lzw")
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+ theme_bw()
dev.off()
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","EmptyDrops"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_old_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)+ theme_bw()
print(gp)
dev.off()
}
G1E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[2,ncol(x$TP_CB2_adj)]))
G1ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[2,ncol(x$TP_ED_adj)]))
G2E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[4,ncol(x$TP_CB2_adj)]))
G2ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[4,ncol(x$TP_ED_adj)]))
G3E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[6,ncol(x$TP_CB2_adj)]))
G3ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[6,ncol(x$TP_ED_adj)]))
FDR_E <- unlist(lapply(Res_list,function(x) x$Stat_adj[2,1]))
FDR_ED <- unlist(lapply(Res_list,function(x) x$Stat_adj[2,2]))
Power_Inc <- unlist(lapply(Res_list,function(x) x$Power_diff_adj))
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","EmptyDrops"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_old_adj_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)+ theme_bw()
print(gp)
dev.off()
}
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/sim/sim_10_3_new.RData")
Res_list <- list()
Res_list[[1]] <- Alz_SIM
Res_list[[2]] <- jurkat_SIM
Res_list[[3]] <- MALT_SIM
Res_list[[4]] <- mbrain_SIM
Res_list[[5]] <- mbrain1K_SIM
Res_list[[6]] <- PanT4K_SIM
Res_list[[7]] <- PBMC33K_SIM
Res_list[[8]] <- PBMC4K_SIM
Res_list[[9]] <- PBMC8K_SIM
Res_list[[10]] <- T293_SIM
G1E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[2,ncol(x$TP_CB2_adj)]))
G1ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[2,ncol(x$TP_ED_adj)]))
G2E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[4,ncol(x$TP_CB2_adj)]))
G2ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[4,ncol(x$TP_ED_adj)]))
G3E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[6,ncol(x$TP_CB2_adj)]))
G3ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[6,ncol(x$TP_ED_adj)]))
FDR_E <- unlist(lapply(Res_list,function(x) x$Stat_adj[2,1]))
FDR_ED <- unlist(lapply(Res_list,function(x) x$Stat_adj[2,2]))
Power_Inc <- unlist(lapply(Res_list,function(x) x$Power_diff_adj))
FDR_plot <- data.frame(FDR=c(FDR_E,FDR_ED),Dataset=NM,Method=rep(c("CB2","EmptyDrops"),each=10))
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/FDR_new1.tif",width=30,height=6,units="cm",res=300, compression = "lzw")
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+ theme_bw()
dev.off()
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","EmptyDrops"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_new_adj_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)+ theme_bw()
print(gp)
dev.off()
}
G1E <- unlist(lapply(Res_list,function(x) x$TP_CB2[2,ncol(x$TP_CB2)]))
G1ED <- unlist(lapply(Res_list,function(x) x$TP_ED[2,ncol(x$TP_ED)]))
G2E <- unlist(lapply(Res_list,function(x) x$TP_CB2[4,ncol(x$TP_CB2)]))
G2ED <- unlist(lapply(Res_list,function(x) x$TP_ED[4,ncol(x$TP_ED)]))
G3E <- unlist(lapply(Res_list,function(x) x$TP_CB2[6,ncol(x$TP_CB2)]))
G3ED <- unlist(lapply(Res_list,function(x) x$TP_ED[6,ncol(x$TP_ED)]))
FDR_E <- unlist(lapply(Res_list,function(x) x$Stat[2,1]))
FDR_ED <- unlist(lapply(Res_list,function(x) x$Stat[2,2]))
Power_Inc <- unlist(lapply(Res_list,function(x) x$Power_diff))
FDR_plot <- data.frame(FDR=c(FDR_E,FDR_ED),Dataset=NM,Method=rep(c("CB2","ED"),each=10))
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/FDR_new1.tif",width=30,height=6,units="cm",res=300, compression = "lzw")
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+ theme_bw()
dev.off()
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","ED"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_new_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)+ theme_bw()
print(gp)
dev.off()
}
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","ED"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_new_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)+ theme_bw()
print(gp)
dev.off()
}
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+ theme_bw()
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+ theme_bw()+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
FDR_plot
NM <- c("Alzheimer","jurkat","MALT","mbrain9K","mbrain1K","PanT4K","PBMC33K","PBMC4K","PBMC8K","T293")
NM_order <- c("mbrain1K","T293","jurkat","PanT4K","MALT","PBMC4K","mbrain9K","Alzheimer","PBMC8K","PBMC33K")
FDR_plot <- data.frame(FDR=c(FDR_E,FDR_ED),Dataset=NM,Method=rep(c("CB2","ED"),each=10))
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/FDR_new1.tif",width=30,height=6,units="cm",res=300, compression = "lzw")
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+ theme_bw()+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
dev.off()
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","ED"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_new_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme_bw()+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)
print(gp)
dev.off()
}
G1E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[2,ncol(x$TP_CB2_adj)]))
G1ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[2,ncol(x$TP_ED_adj)]))
G2E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[4,ncol(x$TP_CB2_adj)]))
G2ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[4,ncol(x$TP_ED_adj)]))
G3E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[6,ncol(x$TP_CB2_adj)]))
G3ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[6,ncol(x$TP_ED_adj)]))
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","ED"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_new_adj_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme_bw()+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)
print(gp)
dev.off()
}
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/sim/sim_10_3_old.RData")
Res_list <- list()
Res_list[[1]] <- Alz_SIM
Res_list[[2]] <- jurkat_SIM
Res_list[[3]] <- MALT_SIM
Res_list[[4]] <- mbrain_SIM
Res_list[[5]] <- mbrain1K_SIM
Res_list[[6]] <- PanT4K_SIM
Res_list[[7]] <- PBMC33K_SIM
Res_list[[8]] <- PBMC4K_SIM
Res_list[[9]] <- PBMC8K_SIM
Res_list[[10]] <- T293_SIM
G1E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[2,ncol(x$TP_CB2_adj)]))
G1ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[2,ncol(x$TP_ED_adj)]))
G2E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[4,ncol(x$TP_CB2_adj)]))
G2ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[4,ncol(x$TP_ED_adj)]))
G3E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[6,ncol(x$TP_CB2_adj)]))
G3ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[6,ncol(x$TP_ED_adj)]))
FDR_E <- unlist(lapply(Res_list,function(x) x$Stat_adj[2,1]))
FDR_ED <- unlist(lapply(Res_list,function(x) x$Stat_adj[2,2]))
Power_Inc <- unlist(lapply(Res_list,function(x) x$Power_diff_adj))
FDR_plot <- data.frame(FDR=c(FDR_E,FDR_ED),Dataset=NM,Method=rep(c("CB2","ED"),each=10))
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/FDR_old1.tif",width=30,height=6,units="cm",res=300, compression = "lzw")
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+ theme_bw()+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
dev.off()
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","ED"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_old_adj_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme_bw()+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)
print(gp)
dev.off()
}
G1E <- unlist(lapply(Res_list,function(x) x$TP_CB2[2,ncol(x$TP_CB2)]))
G1ED <- unlist(lapply(Res_list,function(x) x$TP_ED[2,ncol(x$TP_ED)]))
G2E <- unlist(lapply(Res_list,function(x) x$TP_CB2[4,ncol(x$TP_CB2)]))
G2ED <- unlist(lapply(Res_list,function(x) x$TP_ED[4,ncol(x$TP_ED)]))
G3E <- unlist(lapply(Res_list,function(x) x$TP_CB2[6,ncol(x$TP_CB2)]))
G3ED <- unlist(lapply(Res_list,function(x) x$TP_ED[6,ncol(x$TP_ED)]))
FDR_E <- unlist(lapply(Res_list,function(x) x$Stat[2,1]))
FDR_ED <- unlist(lapply(Res_list,function(x) x$Stat[2,2]))
Power_Inc <- unlist(lapply(Res_list,function(x) x$Power_diff))
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","ED"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_old_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme_bw()+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)
print(gp)
dev.off()
}
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/MALT.RData")
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/mbrain.RData")
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/PBMC8K.RData")
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/mbrain1K.RData")
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/placenta.RData")
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/Alzheimer.RData")
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/T293.RData")
T293_r <- Read10X("~/Google Drive/Hallu/DATA/10x/293T/hg19/")
T293_r <- FilterGB(T293_r)
save(T293_r,file="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/T293.RData")
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/jurkat.RData")
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/PanT4K.RData")
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/PBMC4K.RData")
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/mbrain9K.RData")
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/PBMC33K.RData")
tail(rownames(MALT_r))
DATA_list <- list(mbrain=mbrain_r, PanT4K=PanT4K_r, PBMC4K=PBMC4K_r,MALT=MALT_r,T293=T293_r,PBMC33K=PBMC33K_r,jurkat=jurkat_r)
DATA_CB2ED <- list()
names(DATA_list)
for(i in seq_along(DATA_list)){
raw.dat <- DATA_list[[i]]
print(names(DATA_list)[i])
raw_knee <- barcodeRanks(raw.dat,lower = 100)@metadata$knee
protein <- grep(pattern = "TotalSeqB", x = rownames(raw.mat))
if (length(protein) > 0) {
raw.mat <- raw.mat[-protein, ]
}
set.seed(SEED)
CB2Out <- CB2FindCell(raw.mat,upper = raw_knee, Ncores = 4 )
set.seed(SEED)
eOut <- emptyDrops(raw.mat,retain = raw_knee, lower=100)
ED <- raw.mat[,ifelse(is.na(eOut$FDR),FALSE,eOut$FDR<=0.01)]
CB2 <- GetCellMat(CB2Out)
cat("Whole result comparison: \n")
diff <- barcode_diff(CB2,ED)
cat("below knee point comparison: \n")
diff_knee <- barcode_diff(CB2[,Matrix::colSums(CB2)<raw_knee],ED[,Matrix::colSums(ED)<raw_knee])
DATA_CB2ED[[i]] <- diff
}
for(i in seq_along(DATA_list)){
raw.mat <- DATA_list[[i]]
print(names(DATA_list)[i])
raw_knee <- barcodeRanks(raw.mat,lower = 100)@metadata$knee
protein <- grep(pattern = "TotalSeqB", x = rownames(raw.mat))
if (length(protein) > 0) {
raw.mat <- raw.mat[-protein, ]
}
set.seed(SEED)
CB2Out <- CB2FindCell(raw.mat,upper = raw_knee, Ncores = 4 )
set.seed(SEED)
eOut <- emptyDrops(raw.mat,retain = raw_knee, lower=100)
ED <- raw.mat[,ifelse(is.na(eOut$FDR),FALSE,eOut$FDR<=0.01)]
CB2 <- GetCellMat(CB2Out)
cat("Whole result comparison: \n")
diff <- barcode_diff(CB2,ED)
cat("below knee point comparison: \n")
diff_knee <- barcode_diff(CB2[,Matrix::colSums(CB2)<raw_knee],ED[,Matrix::colSums(ED)<raw_knee])
DATA_CB2ED[[i]] <- diff
}
source("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/functions_forReal.R")
for(i in seq_along(DATA_list)){
raw.mat <- DATA_list[[i]]
print(names(DATA_list)[i])
raw_knee <- barcodeRanks(raw.mat,lower = 100)@metadata$knee
protein <- grep(pattern = "TotalSeqB", x = rownames(raw.mat))
if (length(protein) > 0) {
raw.mat <- raw.mat[-protein, ]
}
set.seed(SEED)
CB2Out <- CB2FindCell(raw.mat,upper = raw_knee, Ncores = 4 )
set.seed(SEED)
eOut <- emptyDrops(raw.mat,retain = raw_knee, lower=100)
ED <- raw.mat[,ifelse(is.na(eOut$FDR),FALSE,eOut$FDR<=0.01)]
CB2 <- GetCellMat(CB2Out)
cat("Whole result comparison: \n")
diff <- barcode_diff(CB2,ED)
cat("below knee point comparison: \n")
diff_knee <- barcode_diff(CB2[,Matrix::colSums(CB2)<raw_knee],ED[,Matrix::colSums(ED)<raw_knee])
DATA_CB2ED[[i]] <- diff
}
names(DATA_CB2ED) <- names(DATA_list)
save(DATA_CB2ED, file = "~/Google Drive/Hallu/codes/ckgroup/DropletUtils/7data_CB2ED.RData")
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/sim/sim_10_3_new.RData")
Res_list <- list()
Res_list[[1]] <- Alz_SIM
Res_list[[2]] <- jurkat_SIM
Res_list[[3]] <- MALT_SIM
Res_list[[4]] <- mbrain_SIM
Res_list[[5]] <- mbrain1K_SIM
Res_list[[6]] <- PanT4K_SIM
Res_list[[7]] <- PBMC33K_SIM
Res_list[[8]] <- PBMC4K_SIM
Res_list[[9]] <- PBMC8K_SIM
Res_list[[10]] <- T293_SIM
NM <- c("Alzheimer","jurkat","MALT","mbrain9K","mbrain1K","PanT4K","PBMC33K","PBMC4K","PBMC8K","T293")
G1E <- unlist(lapply(Res_list,function(x) x$TP_CB2[2,ncol(x$TP_CB2)]))
G1ED <- unlist(lapply(Res_list,function(x) x$TP_ED[2,ncol(x$TP_ED)]))
G2E <- unlist(lapply(Res_list,function(x) x$TP_CB2[4,ncol(x$TP_CB2)]))
G2ED <- unlist(lapply(Res_list,function(x) x$TP_ED[4,ncol(x$TP_ED)]))
G3E <- unlist(lapply(Res_list,function(x) x$TP_CB2[6,ncol(x$TP_CB2)]))
G3ED <- unlist(lapply(Res_list,function(x) x$TP_ED[6,ncol(x$TP_ED)]))
FDR_E <- unlist(lapply(Res_list,function(x) x$Stat[2,1]))
FDR_ED <- unlist(lapply(Res_list,function(x) x$Stat[2,2]))
Power_Inc <- unlist(lapply(Res_list,function(x) x$Power_diff))
NM_order <- c("mbrain1K","T293","jurkat","PanT4K","MALT","PBMC4K","mbrain9K","Alzheimer","PBMC8K","PBMC33K")
FDR_plot <- data.frame(FDR=c(FDR_E,FDR_ED),Dataset=NM,Method=rep(c("CB2","ED"),each=10))
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/FDR_new1.tif",width=30,height=6,units="cm",res=300, compression = "lzw")
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+ theme_bw()+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
dev.off()
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","ED"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_new_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme_bw()+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)
print(gp)
dev.off()
}
G1E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[2,ncol(x$TP_CB2_adj)]))
G1ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[2,ncol(x$TP_ED_adj)]))
G2E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[4,ncol(x$TP_CB2_adj)]))
G2ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[4,ncol(x$TP_ED_adj)]))
G3E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[6,ncol(x$TP_CB2_adj)]))
G3ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[6,ncol(x$TP_ED_adj)]))
FDR_E <- unlist(lapply(Res_list,function(x) x$Stat_adj[2,1]))
FDR_ED <- unlist(lapply(Res_list,function(x) x$Stat_adj[2,2]))
Power_Inc <- unlist(lapply(Res_list,function(x) x$Power_diff_adj))
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","ED"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_new_adj_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme_bw()+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)
print(gp)
dev.off()
}
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/sim/sim_10_3_old.RData")
Res_list <- list()
Res_list[[1]] <- Alz_SIM
Res_list[[2]] <- jurkat_SIM
Res_list[[3]] <- MALT_SIM
Res_list[[4]] <- mbrain_SIM
Res_list[[5]] <- mbrain1K_SIM
Res_list[[6]] <- PanT4K_SIM
Res_list[[7]] <- PBMC33K_SIM
Res_list[[8]] <- PBMC4K_SIM
Res_list[[9]] <- PBMC8K_SIM
Res_list[[10]] <- T293_SIM
G1E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[2,ncol(x$TP_CB2_adj)]))
G1ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[2,ncol(x$TP_ED_adj)]))
G2E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[4,ncol(x$TP_CB2_adj)]))
G2ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[4,ncol(x$TP_ED_adj)]))
G3E <- unlist(lapply(Res_list,function(x) x$TP_CB2_adj[6,ncol(x$TP_CB2_adj)]))
G3ED <- unlist(lapply(Res_list,function(x) x$TP_ED_adj[6,ncol(x$TP_ED_adj)]))
FDR_E <- unlist(lapply(Res_list,function(x) x$Stat_adj[2,1]))
FDR_ED <- unlist(lapply(Res_list,function(x) x$Stat_adj[2,2]))
Power_Inc <- unlist(lapply(Res_list,function(x) x$Power_diff_adj))
FDR_plot <- data.frame(FDR=c(FDR_E,FDR_ED),Dataset=NM,Method=rep(c("CB2","ED"),each=10))
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/FDR_old1.tif",width=30,height=6,units="cm",res=300, compression = "lzw")
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+ theme_bw()+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
dev.off()
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","ED"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_old_adj_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme_bw()+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)
print(gp)
dev.off()
}
G1E <- unlist(lapply(Res_list,function(x) x$TP_CB2[2,ncol(x$TP_CB2)]))
G1ED <- unlist(lapply(Res_list,function(x) x$TP_ED[2,ncol(x$TP_ED)]))
G2E <- unlist(lapply(Res_list,function(x) x$TP_CB2[4,ncol(x$TP_CB2)]))
G2ED <- unlist(lapply(Res_list,function(x) x$TP_ED[4,ncol(x$TP_ED)]))
G3E <- unlist(lapply(Res_list,function(x) x$TP_CB2[6,ncol(x$TP_CB2)]))
G3ED <- unlist(lapply(Res_list,function(x) x$TP_ED[6,ncol(x$TP_ED)]))
FDR_E <- unlist(lapply(Res_list,function(x) x$Stat[2,1]))
FDR_ED <- unlist(lapply(Res_list,function(x) x$Stat[2,2]))
Power_Inc <- unlist(lapply(Res_list,function(x) x$Power_diff))
sim_plot <- data.frame(Power=c(G1E,G1ED,G2E,G2ED,G3E,G3ED),Group=rep(c("G1","G1.5","G2"),each=20), Method=rep(rep(c("CB2","ED"),each=10),3),Dataset=rep(NM,6))
for(temp in NM){
temp_plot <- sim_plot[sim_plot$Dataset==temp,]
fname <- paste0("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/Power_old_",temp,".tif")
tiff(filename =fname,width=3.5,height=8,units="cm",res=300, compression = "lzw")
gp <- ggplot(data=temp_plot,aes(y=Power,x=Group))+geom_col(aes(fill=Method),position="dodge")+labs(title=temp)+ylim(0,1)+ theme_bw()+ theme(plot.title = element_text(size=12), legend.position = "none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+xlab(NULL)
print(gp)
dev.off()
}
NM_order <- c("Alzheimer","PBMC8K","PBMC33K", "mbrain1K","mbrain9K","PanT4K","MALT", "PBMC4K","jurkat","T293")
FDR_plot <- data.frame(FDR=c(FDR_E,FDR_ED),Dataset=NM,Method=rep(c("CB2","ED"),each=10))
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/FDR_old1.tif",width=30,height=6,units="cm",res=300, compression = "lzw")
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+ theme_bw()+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
dev.off()
load("~/Google Drive/Hallu/codes/ckgroup/DropletUtils/sim/sim_10_3_new.RData")
Res_list <- list()
Res_list[[1]] <- Alz_SIM
Res_list[[2]] <- jurkat_SIM
Res_list[[3]] <- MALT_SIM
Res_list[[4]] <- mbrain_SIM
Res_list[[5]] <- mbrain1K_SIM
Res_list[[6]] <- PanT4K_SIM
Res_list[[7]] <- PBMC33K_SIM
Res_list[[8]] <- PBMC4K_SIM
Res_list[[9]] <- PBMC8K_SIM
Res_list[[10]] <- T293_SIM
G1E <- unlist(lapply(Res_list,function(x) x$TP_CB2[2,ncol(x$TP_CB2)]))
G1ED <- unlist(lapply(Res_list,function(x) x$TP_ED[2,ncol(x$TP_ED)]))
G2E <- unlist(lapply(Res_list,function(x) x$TP_CB2[4,ncol(x$TP_CB2)]))
G2ED <- unlist(lapply(Res_list,function(x) x$TP_ED[4,ncol(x$TP_ED)]))
G3E <- unlist(lapply(Res_list,function(x) x$TP_CB2[6,ncol(x$TP_CB2)]))
G3ED <- unlist(lapply(Res_list,function(x) x$TP_ED[6,ncol(x$TP_ED)]))
FDR_E <- unlist(lapply(Res_list,function(x) x$Stat[2,1]))
FDR_ED <- unlist(lapply(Res_list,function(x) x$Stat[2,2]))
Power_Inc <- unlist(lapply(Res_list,function(x) x$Power_diff))
FDR_plot <- data.frame(FDR=c(FDR_E,FDR_ED),Dataset=NM,Method=rep(c("CB2","ED"),each=10))
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/FDR_new1.tif",width=30,height=6,units="cm",res=300, compression = "lzw")
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+ theme_bw()+theme(axis.text=element_text(size=12),legend.position="none", panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
dev.off()
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/DropletUtils/manuscript/Rplots/FDR_new1.tif",width=30,height=6,units="cm",res=300, compression = "lzw")
ggplot(data=FDR_plot,aes(y=FDR*100,x=Dataset))+geom_col(aes(fill=Method),position="dodge")+geom_hline(yintercept = 1,linetype="dashed")+ylab("FDR (%)")+ylim(c(0,2))+
scale_x_discrete(limits=(NM_order))+ theme_bw()+theme(axis.text=element_text(size=12), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
dev.off()
