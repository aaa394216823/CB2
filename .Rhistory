axis.line = element_line(colour = "black"))+labs(title=title)
str(gp_tmp)
exists("gp_all")
gp_all <- ifelse(exists("gp_all"),gp_all+gp_tmp,gp_tmp)
str(gp_all)
exists("gp_all")
ifelse(exists("gp_all"),gp_all+gp_tmp,gp_tmp)
rm(gp_all)
ifelse(exists("gp_all"),gp_all+gp_tmp,gp_tmp)
exists("gp_all")
if(exists("gp_all")){
gp_all <- gp_all+gp_tmp
}else{
gp_all <- gp_tmp
}
str(gp_all)
rm(gp_all)
for(celltype in names(DE_list1)){
tmp <- DE_list1[[celltype]]
for(res in names(tmp)){
title <- paste0(celltype," ",res )
tmp2 <- melt(tmp[[res]])
gp_tmp <- ggplot(tmp2,aes(x=Var1, y=value, fill=Var2))+
geom_bar(stat='identity', position='dodge')+ theme_bw() +
theme(axis.text=element_text(size=10),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
legend.title = element_blank(),
panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+labs(title=title)
if(exists("gp_all")){
gp_all <- gp_all+gp_tmp
}else{
gp_all <- gp_tmp
}
}
}
layout <- "AB
CD
EF"
plot(gp_all+plot_layout(design = layout))
length(gp_all)
names(DE_list1)
layout <- "AB
CD
EF
GH"
plot(gp_all+plot_layout(design = layout))
plot(gp_all+plot_layout(design = layout))
plot(gp_all+plot_layout(design = layout))
plot(gp_all+plot_layout(design = layout))
plot(gp_all+plot_layout(design = layout))
mk_plot("SYT1",dat_umap = umap_list$Dino,dat_norm = Alz_Dino) #N, SYT1, SNAP25, GRIN1
load("~/Google Drive/Hallu/codes/ckgroup/COVID19/analysis/All_Raw_new.RData")
A549 <- meta_info$study=="Blanco-Melo"&meta_info$tissue=="A549"
A549_raw <- dat_raw[,A549]
A549_meta <- meta_info[A549,]
# Choose the COVID batch
A549_covid_raw <- A549_raw[,1:6]
A549_covid_meta <- A549_meta[1:6,]
str(A549_covid_raw)
NHBE <- meta_info$study=="Blanco-Melo"&meta_info$tissue=="NHBE"
NHBE_raw <- dat_raw[,NHBE]
NHBE_meta <- meta_info[NHBE,]
################
# Plots for TMPRSS2, FURIN and ADAMTS1
#################
target
################
# Plots for TMPRSS2, FURIN and ADAMTS1
#################
target <- c("TMPRSS2","FURIN","ADAMTS1")
A549_covid_raw[target,]
NHBE_raw[target,]
target <- c("TMPRSS2","FURIN","ADAMTS1")
#A549
A549 <- meta_info$study=="Blanco-Melo"&meta_info$tissue=="A549"
A549_raw <- dat_raw[,A549]
A549_meta <- meta_info[A549,]
# Choose the COVID batch
A549_covid_raw <- A549_raw[,1:6]
A549_covid_meta <- A549_meta[1:6,]
# filter out low expressors
# TMPRSS2 is 0
toKeep <- rowMeans(A549_covid_raw)>=1
A549_covid_raw <- A549_covid_raw[toKeep,]
# Apply DESeq2
dds_A549 <- DESeqDataSetFromMatrix(countData = round(A549_covid_raw),
colData = A549_covid_meta,
design= ~ condition)
dds_A549 <- DESeq(dds_A549)
A549_norm <- counts(dds_A549, normalized = TRUE)
library(DESeq2)
library(ggplot2)
library(patchwork)
library(tidyverse)
A549 <- meta_info$study=="Blanco-Melo"&meta_info$tissue=="A549"
A549_raw <- dat_raw[,A549]
A549_meta <- meta_info[A549,]
# Choose the COVID batch
A549_covid_raw <- A549_raw[,1:6]
A549_covid_meta <- A549_meta[1:6,]
# filter out low expressors
# TMPRSS2 is 0
toKeep <- rowMeans(A549_covid_raw)>=1
A549_covid_raw <- A549_covid_raw[toKeep,]
# Apply DESeq2
dds_A549 <- DESeqDataSetFromMatrix(countData = round(A549_covid_raw),
colData = A549_covid_meta,
design= ~ condition)
dds_A549 <- DESeq(dds_A549)
A549_norm <- counts(dds_A549, normalized = TRUE)
A549_norm[target,]
A549_norm[target[-1],]
NHBE <- meta_info$study=="Blanco-Melo"&meta_info$tissue=="NHBE"
NHBE_raw <- dat_raw[,NHBE]
NHBE_meta <- meta_info[NHBE,]
# filter out low expressors
toKeep <- rowMeans(NHBE_raw)>=1
NHBE_raw <- NHBE_raw[toKeep,]
# Apply DESeq2
dds_NHBE <- DESeqDataSetFromMatrix(countData = round(NHBE_raw),
colData = NHBE_meta,
design= ~ condition)
dds_NHBE <- DESeq(dds_NHBE)
NHBE_norm <- counts(dds_NHBE, normalized = TRUE)
NHBE_norm[target,]
NHBE_norm[target,]%>%melt
rownames(NHBE_target) <- rep(c("Mock","SARS-CoV-2"),each=3)
NHBE_target <- NHBE_norm[target,]
rownames(NHBE_target) <- rep(c("Mock","SARS-CoV-2"),each=3)
dim( NHBE_norm)
rep(c("Mock","SARS-CoV-2"),each=3)
NHBE_target <- data.frame(NHBE_norm[target,])
colnames(NHBE_target) <- rep(c("Mock","SARS-CoV-2"),each=3)
NHBE_target
NHBE_target$Mock
NHBE_target <- NHBE_norm[target,]
colnames(NHBE_target) <- rep(c("Mock","SARS-CoV-2"),each=3)
NHBE_target <- NHBE_norm[target,]
colnames(NHBE_target) <- rep(c("Mock","SARS-CoV-2"),each=3)
NHBE_target
NHBE_target <- cbind(NHBE_target,rowMeans(NHBE_target[,1:3]),rowMeans(NHBE_target[,4:6]))
NHBE_target
colnames(NHBE_target) <- rep(c("Mock","SARS-CoV-2","Ave"),c(3,3,2))
NHBE_target
NHBE_target <- NHBE_norm[target,]
NHBE_target <- cbind(NHBE_target,rowMeans(NHBE_target[,1:3]),rowMeans(NHBE_target[,4:6]))
colnames(NHBE_target) <- rep(c("Mock","SARS-CoV-2","Mock_Ave","S_Ave"),c(3,3,1,1))
NHBE_target
NHBE_target%>%melt
NHBE_target <- NHBE_norm[target,]
NHBE_target <- cbind(NHBE_target,rowMeans(NHBE_target[,1:3]),rowMeans(NHBE_target[,4:6]))
colnames(NHBE_target) <- rep(c("Mock","SARS-CoV-2","Mock","S"),c(3,3,1,1))
NHBE_target <- melt(NHBE_target)
NHBE_target
NHBE_target <- NHBE_norm[target,]
NHBE_target <- cbind(NHBE_target,rowMeans(NHBE_target[,1:3]),rowMeans(NHBE_target[,4:6]))
colnames(NHBE_target) <- rep(c("Mock","SARS-CoV-2","Mock","SARS-CoV-2"),c(3,3,1,1))
NHBE_target <- melt(NHBE_target)
str(NHBE_target)
ggplot()+geom_bar(data=NHBE_target[19:24,],aes(x=Var1,y=value,fill=Var2))
ggplot()+geom_bar(data=NHBE_target[19:24,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")
boxplot(1:3)
ggplot()+geom_boxplot(data=NHBE_target[1:18,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")
ggplot()+geom_bar(data=NHBE_target[19:24,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")
ggplot()+geom_bar(data=NHBE_target[19:24,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")+
geom_point(data=NHBE_target[1:18,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")
ggplot()+geom_bar(data=NHBE_target[19:24,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")+
geom_point(data=NHBE_target[1:18,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position=position_dodge(width = .9))
ggplot()+geom_bar(data=NHBE_target[19:24,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")+
geom_point(data=NHBE_target[1:18,],aes(x=Var1,y=value,col=Var2),stat="identity",
position=position_dodge(width = .9))
ggplot()+geom_bar(data=NHBE_target[19:24,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")+
geom_point(data=NHBE_target[1:18,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position=position_dodge(width = .9))
ggplot()+geom_bar(data=NHBE_target[19:24,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")+
geom_point(data=NHBE_target[1:18,],aes(x=Var1,y=value,group=Var2),stat="identity",
position=position_dodge(width = .9))
A549_target <- A549_norm[target,]
A549_target <- A549_norm[target[-1],]
A549_target
NHBE_target
NHBE_norm[target,]
rbind(0,A549_norm[target[-1],])
A549_target <- rbind(0,A549_norm[target[-1],])
rownames(A549_target)[1] <- "TMPRSS2"
A549_target <- cbind(A549_target,rowMeans(A549_target[,1:3]),rowMeans(A549_target[,4:6]))
colnames(A549_target) <- rep(c("Mock","SARS-CoV-2","Mock","SARS-CoV-2"),c(3,3,1,1))
A549_target <- melt(A549_target)
A549_target
ggplot()+geom_bar(data=A549_target[19:24,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")+
geom_point(data=A549_target[1:18,],aes(x=Var1,y=value,group=Var2),stat="identity",
position=position_dodge(width = .9))
ggplot()+geom_bar(data=A549_target[19:24,],aes(x=Var1,y=log1p(value),fill=Var2),stat="identity",
position="dodge")+
geom_point(data=A549_target[1:18,],aes(x=Var1,y=log1p(value),group=Var2),stat="identity",
position=position_dodge(width = .9))
NHBE_target
A549_target
A549_FC <- results(dds_A549, name="condition_Normal_vs_COVID")[target[-1],]
A549_FC
A549_FC <- results(dds_A549, name="condition_Normal_vs_COVID")[target[-1],2]
A549_FC
A549_target
1777.7333716/1655.8359717
log(1777.7333716/1655.8359717)
A549_norm["FURIN",]
log(mean(A549_norm["FURIN",1:3])/mean(A549_norm["FURIN",4:6]))
log2(mean(A549_norm["FURIN",1:3])/mean(A549_norm["FURIN",4:6]))
log2(mean(A549_covid_raw["FURIN",1:3])/mean(A549_covid_raw["FURIN",4:6]))
A549_covid_raw["FURIN",1:3]
A549_covid_raw["FURIN",4:6]
A549_FC
mean(A549_covid_raw["FURIN",1:3])/mean(A549_covid_raw["FURIN",4:6])
mean(A549_covid_raw["FURIN",4:6])
A549_covid_raw["FURIN",4:6]
A549_covid_raw["FURIN",4:6]%>%mean
A549_FC <- results(dds_A549, name="condition_Normal_vs_COVID")[target[-1],2]
A549_FC
NHBE_FC <- results(dds_NHBE, name="condition_Normal_vs_COVID")[target,2]
NHBE_FC
FC <- cbind(A549_FC,NHBE_FC)
A549_FC
A549_FC <- c(NA,results(dds_A549, name="condition_Normal_vs_COVID")[target[-1],2])
FC <- cbind(A549_FC,NHBE_FC)
FC
rownames(FC) <- target
FC
log2FC <- cbind(A549_FC,NHBE_FC)
rownames(log2FC) <- target
log2FC
melt(log2FC)
ggplot()+geom_bar(data=A549_target[19:24,],aes(x=Var1,y=log1p(value),fill=Var2),stat="identity",
position="dodge")+
geom_point(data=A549_target[1:18,],aes(x=Var1,y=log1p(value),group=Var2),stat="identity",
position=position_dodge(width = .9))+labs(title="A549")
ggplot()+geom_bar(data=NHBE_target[19:24,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")+
geom_point(data=NHBE_target[1:18,],aes(x=Var1,y=value,group=Var2),stat="identity",
position=position_dodge(width = .9))+labs(title="NHBE")
log2FC
log2FC <- melt(log2FC)
log2FC
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")
log2FC <- cbind(A549_FC,NHBE_FC)
rownames(log2FC) <- target
colnames(log2FC) <- c("A549","NHBE")
log2FC <- melt(log2FC)
log2FC
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")
ggplot()+geom_bar(data=A549_target[19:24,],aes(x=Var1,y=log1p(value),fill=Var2),stat="identity",
position="dodge")+
geom_point(data=A549_target[1:18,],aes(x=Var1,y=log1p(value),group=Var2),stat="identity",
position=position_dodge(width = .9))+labs(title="A549")
ggplot()+geom_bar(data=A549_target[19:24,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")+
geom_point(data=A549_target[1:18,],aes(x=Var1,y=value,group=Var2),stat="identity",
position=position_dodge(width = .9))+labs(title="A549")
ggplot()+geom_bar(data=NHBE_target[19:24,],aes(x=Var1,y=value,fill=Var2),stat="identity",
position="dodge")+
geom_point(data=NHBE_target[1:18,],aes(x=Var1,y=value,group=Var2),stat="identity",
position=position_dodge(width = .9))+labs(title="NHBE")
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")
################
# Plots for TMPRSS2, FURIN and ADAMTS1
#################
target <- c("ACE2","TMPRSS2","FURIN","ADAMTS1")
A549_norm[target,]
A549_norm[target[-2],]
A549_norm[target[-1],]
A549_FC <- c(NA,results(dds_A549, name="condition_Normal_vs_COVID")[target,2])
A549_FC
A549_raw["ACE2",]
NHBE_raw["ACE2",]
A549_FC <- results(dds_A549, name="condition_Normal_vs_COVID")[target,2]
NHBE_FC <- results(dds_NHBE, name="condition_Normal_vs_COVID")[target,2]
NHBE_FC
counts(dds_NHBE, normalized = TRUE)["ACE2",]
A549_FC <- 1/results(dds_A549, name="condition_Normal_vs_COVID")[target,2]
NHBE_FC <- 1/results(dds_NHBE, name="condition_Normal_vs_COVID")[target,2]
log2FC <- cbind(A549_FC,NHBE_FC)
rownames(log2FC) <- target
colnames(log2FC) <- c("A549","NHBE")
log2FC <- melt(log2FC)
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")
A549_FC <- -results(dds_A549, name="condition_Normal_vs_COVID")[target,2]
NHBE_FC <- -results(dds_NHBE, name="condition_Normal_vs_COVID")[target,2]
log2FC <- cbind(A549_FC,NHBE_FC)
rownames(log2FC) <- target
colnames(log2FC) <- c("A549","NHBE")
log2FC <- melt(log2FC)
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.major = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title = element_blank())
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),
axis.title.y = element_text("log2FC"))
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),
axis.title.y = element_text(text="log2FC"))
?element_text
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),
axis.title.y = "log2FC"))
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),
axis.title.y = "log2FC")
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank())
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank())
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),legend.title = element_blank())
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2, width=0.5))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),legend.title = element_blank())
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2, width=0.3))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),legend.title = element_blank())
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2, width=0.8))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),legend.title = element_blank())
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2, width=0.7))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),legend.title = element_blank())
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2, width=0.5))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),legend.title = element_blank())
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2, width=0.6))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),legend.title = element_blank())
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/COVID19/analysis/TargetGene_log2FC.tif",
width=2,height=5,units="in",res=300, compression = "lzw")
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2, width=0.6))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),legend.title = element_blank())
dev.off()
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/COVID19/analysis/TargetGene_log2FC.tif",
width=6,height=5,units="in",res=300, compression = "lzw")
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2, width=0.6))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),legend.title = element_blank())
dev.off()
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/COVID19/analysis/TargetGene_log2FC.tif",
width=5,height=5,units="in",res=300, compression = "lzw")
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2, width=0.6))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),legend.title = element_blank())
dev.off()
tiff(filename ="~/Google Drive/Hallu/codes/ckgroup/COVID19/analysis/TargetGene_log2FC.tif",
width=4,height=5,units="in",res=300, compression = "lzw")
ggplot(data=log2FC,aes(x=Var1,y=value,fill=Var2, width=0.6))+
geom_bar(stat="identity",position="dodge")+
guides(colour = guide_legend(override.aes = list(size=2)))+
theme_bw() + ylab("log2FC")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=1.5),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x = element_blank(),legend.title = element_blank())
dev.off()
install.packages("~/Google Drive/GitHub/scCB2/scCB2_0.99.17.tar.gz", type="source", repos = NULL)
devtools::build()
setwd("~/Google Drive/GitHub/scCB2/scCB2")
devtools::build()
remove.packages("scCB2")
install.packages("~/Google Drive/GitHub/scCB2/scCB2_0.99.17.tar.gz", type="source", repos = NULL)
document()
library(devtools)
document()
remove.packages("scCB2")
build()
install.packages("~/Google Drive/GitHub/scCB2/scCB2_0.99.17.tar.gz", type="source", repos = NULL)
